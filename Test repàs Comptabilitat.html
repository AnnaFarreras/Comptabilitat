<!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test rep√†s de Comptabilitat</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800 min-h-screen p-4">
  <div id="app" class="max-w-xl w-full bg-white shadow-xl rounded-2xl p-6">
    <h1 class="text-2xl font-bold mb-4 text-center">Test rep√†s de Comptabilitat</h1>
    <div id="barra-nivells" class="flex gap-2 flex-wrap justify-center mb-4">
      <button onclick="iniciaNivell(1)" class="bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600">Nivell 1</button>
      <button onclick="iniciaNivell(2)" class="bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600">Nivell 2</button>
      <button onclick="iniciaNivell(3)" class="bg-yellow-500 text-white px-3 py-1 rounded hover:bg-yellow-600">Nivell 3</button>
      <button onclick="iniciaNivell(4)" class="bg-purple-500 text-white px-3 py-1 rounded hover:bg-purple-700">Nivell 4</button>
    </div>

    <div id="quiz-container" class="mb-4"></div>
    <div class="flex justify-between items-center mt-6">
      <div id="score" class="text-sm text-gray-600">Encerts: 0 / 0</div>
      <button id="next-btn" class="hidden bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Seg√ºent</button>
    </div>
  </div>

  <script>
    const nivells = {
      1: [
        {
          tipus: "test",
          pregunta: "Quina √©s la funci√≥ principal de la comptabilitat?",
          opcions: [
            "Fer publicitat dels productes",
            "Produir informaci√≥ financera per prendre decisions",
            "Registrar horaris del personal",
            "Fer informes comercials"
          ],
          correcta: 1
        },
        {
          tipus: "test",
          pregunta: "Quina difer√®ncia hi ha entre deure i haver?",
          opcions: [
            "El deure sempre √©s negatiu",
            "El deure √©s a l'esquerra, el haver a la dreta",
            "El deure √©s per a ingressos",
            "No hi ha difer√®ncia"
          ],
          correcta: 1
        },
        {
          tipus: "test",
          pregunta: "Quin llibre registra les operacions agrupades per comptes?",
          opcions: ["Llibre Major", "Llibre Diari", "Balan√ß", "Mem√≤ria"],
          correcta: 0
        },
        {
          tipus: "test",
          pregunta: "El llibre d'inventaris cont√©:",
          opcions: [
            "Els assentaments del dia",
            "El detall del balan√ß i altres informes anuals",
            "Els cobraments i pagaments",
            "Els horaris de treball"
          ],
          correcta: 1
        },
        {
          tipus: "test",
          pregunta: "Quin compte representa l'IVA suportat?",
          opcions: ["(472)", "(477)", "(700)", "(570)"],
          correcta: 0
        },
        {
          tipus: "test",
          pregunta: "Quin compte representa l'IVA repercutit?",
          opcions: ["(472)", "(477)", "(400)", "(430)"],
          correcta: 1
        },
        {
          tipus: "test",
          pregunta: "Quin document s'utilitza per iniciar un assentament?",
          opcions: ["Extracte bancari", "Contracte laboral", "Factura", "Mem√≤ria econ√≤mica"],
          correcta: 2
        },
        {
          tipus: "test",
          pregunta: "Quin compte s'utilitza per registrar l'efectiu en caixa?",
          opcions: ["(570)", "(572)", "(430)", "(400)"],
          correcta: 0
        },
        {
          tipus: "test",
          pregunta: "A quin llibre es transcriuen cronol√≤gicament tots els assentaments?",
          opcions: ["Major", "Diari", "Balan√ß", "Mem√≤ria"],
          correcta: 1
        },
        {
          tipus: "test",
          pregunta: "Quin llibre comptable no √©s obligatori per a totes les empreses segons el Codi de Comer√ß espanyol, per√≤ s√≠ altament recomanable per a la gesti√≥ interna?",
          opcions: ["Llibre Diari", "Llibre Major", "Llibre d'Inventaris i Comptes Anuals", "Tots s√≥n obligatoris"],
          correcta: 1
        },
        {
          tipus: "completar",
          frase: "El llibre ___ recull les operacions per ordre cronol√≤gic.",
          opcions: ["Major", "Inventaris", "Diari", "Caixa"],
          correcta: "Diari"
        },
        {
          tipus: "completar",
          frase: "Els comptes del grup 6 s'utilitzen per registrar les ___ de l'activitat.",
          opcions: ["vendes", "reserves", "despeses", "exist√®ncies"],
          correcta: "despeses"
        },
        {
          tipus: "completar",
          frase: "El compte ___ reflecteix les entrades de diners a l'empresa.",
          opcions: ["(700)", "(572)", "(600)", "(430)"],
          correcta: "(572)"
        },
        {
          tipus: "completar",
          frase: "El compte ___ recull les vendes de mercaderies.",
          opcions: ["(600)", "(430)", "(700)", "(477)"],
          correcta: "(700)"
        },
        {
          tipus: "relacionar",
          pregunta: "Relaciona els grups de comptes amb la seva funci√≥:",
          parelles: [
            { esquerra: "Grup 1", opcions: ["Ingressos", "Finan√ßament b√†sic", "Despeses"], correcta: "Finan√ßament b√†sic" },
            { esquerra: "Grup 6", opcions: ["Ingressos", "Despeses", "Prove√Ødors"], correcta: "Despeses" },
            { esquerra: "Grup 7", opcions: ["Clients", "Ingressos", "Despeses"], correcta: "Ingressos" }
          ]
        },
        {
          tipus: "relacionar",
          pregunta: "Relaciona cada compte amb el seu tipus:",
          parelles: [
            { esquerra: "(430) Clients", opcions: ["Ingressos", "Actiu", "Passiu"], correcta: "Actiu" },
            { esquerra: "(400) Prove√Ødors", opcions: ["Despeses", "Passiu", "Actiu"], correcta: "Passiu" },
            { esquerra: "(700) Venda de mercaderies", opcions: ["Actiu", "Ingressos", "Passiu"], correcta: "Ingressos" }
          ]
        },
        {
          tipus: "relacionar",
          pregunta: "Relaciona el llibre amb la seva descripci√≥:",
          parelles: [
            { esquerra: "Diari", opcions: ["Resum de saldos", "Operacions cronol√≤giques", "Ingressos i despeses"], correcta: "Operacions cronol√≤giques" },
            { esquerra: "Major", opcions: ["Ingressos", "Resum de saldos", "Detall per compte"], correcta: "Detall per compte" },
            { esquerra: "Compte de p√®rdues i guanys", opcions: ["Actiu i passiu", "Ingressos i despeses", "Cronologia d‚Äôoperacions"], correcta: "Ingressos i despeses" }
          ]
        },
        {
          tipus: "relacionar",
          pregunta: "Relaciona els comptes amb el seu tipus:",
          parelles: [
            { esquerra: "(640) Sous i salaris", opcions: ["Ingressos", "Despesa", "Passiu"], correcta: "Despesa" },
            { esquerra: "(4751) Hisenda P. retencions", opcions: ["Actiu", "Passiu", "Despesa"], correcta: "Passiu" },
            { esquerra: "(570) Caixa", opcions: ["Passiu", "Tresoreria", "Resultat"], correcta: "Tresoreria" }
          ]
        },
{
  tipus: "test",
  pregunta: "L'objectiu principal de la comptabilitat √©s:",
  opcions: [
    "Registrar totes les operacions de compra i venda",
    "Produir informaci√≥ financera per a la presa de decisions",
    "Calcular els impostos a pagar per l'empresa",
    "Gestionar el personal de l'empresa"
  ],
  correcta: 1
},
{
  tipus: "completar",
  frase: "El compte (206) 'Aplicacions inform√†tiques' es classifica com a immobilitzat ___.",
  opcions: ["material", "financera", "intangible", "corrent"],
  correcta: "intangible"
},
{
  tipus: "completar",
  frase: "El capital social √©s una part del ___ de l'empresa.",
  opcions: ["passiu corrent", "passiu no corrent", "patrimoni net", "actiu corrent"],
  correcta: "patrimoni net"
},
{
  tipus: "relacionar",
  pregunta: "Relaciona el concepte d'IVA amb el seu impacte o compte relacionat:",
  parelles: [
    { esquerra: "IVA Suportat", opcions: ["Impost cobrat al client", "Impost pagat en les compres", "Impost a pagar a Hisenda"], correcta: "Impost pagat en les compres" },
    { esquerra: "IVA Repercutit", opcions: ["Impost pagat al prove√Ødor", "Impost incl√≤s en el preu de venda", "Impost a compensar"], correcta: "Impost incl√≤s en el preu de venda" },
    { esquerra: "(470) Hisenda P√∫blica, deutora per IVA", opcions: ["Resultat liquidaci√≥ a pagar", "Resultat liquidaci√≥ a favor de l'empresa", "IVA cobrat i no declarat"], correcta: "Resultat liquidaci√≥ a favor de l'empresa" }
  ]
}
      ],
      2: [
        {
          tipus: "test",
          pregunta: "El balan√ß de situaci√≥ mostra l' ___ patrimonial d'una empresa en un moment determinat.",
          opcions: ["estructura", "evoluci√≥", "ingr√©s", "descompte"],
          correcta: 0
        },
        {
          tipus: "test",
          pregunta: "Quin compte representa una despesa financera?",
          opcions: ["(660)", "(700)", "(572)", "(430)"],
          correcta: 0
        },
        {
          tipus: "test",
          pregunta: "Quin compte forma part del passiu exigible?",
          opcions: ["(430)", "(400)", "(572)", "(700)"],
          correcta: 1
        },
        {
          tipus: "test",
          pregunta: "Quin compte representa l'efectiu en caixa?",
          opcions: ["(570)", "(572)", "(430)", "(400)"],
          correcta: 0
        },
        {
          tipus: "test",
          pregunta: "Quin compte representa els saldos bancaris disponibles?",
          opcions: ["(570)", "(572)", "(700)", "(400)"],
          correcta: 1
        },
        {
          tipus: "test",
          pregunta: "El llibre Major mostra:",
          opcions: ["El resum cronol√≤gic de les operacions", "Els assentaments agrupats per compte", "Els balan√ßos mensuals", "La mem√≤ria de gesti√≥"],
          correcta: 1
        },
        {
          tipus: "test",
          pregunta: "El compte (600) correspon a:",
          opcions: ["Venda de mercaderies", "Compra de mercaderies", "Client", "Subministraments"],
          correcta: 1
        },
        {
          tipus: "test",
          pregunta: "El compte (700) correspon a:",
          opcions: ["Venda de mercaderies", "Compra de mercaderies", "Tresoreria", "Amortitzaci√≥"],
          correcta: 0
        },
        {
          tipus: "test",
          pregunta: "Quin llibre inclou el balan√ß de situaci√≥ i el compte de p√®rdues i guanys?",
          opcions: ["Llibre Diari", "Llibre Major", "Llibre d'Inventaris i Comptes Anuals", "Mem√≤ria"],
          correcta: 2
        },
        {
          tipus: "test",
          pregunta: "Quin dels seg√ºents NO √©s un actiu corrent?",
          opcions: ["(300) Mercaderies", "(430) Clients", "(572) Bancs", "(200) R+D"],
          correcta: 3
        },
        {
          tipus: "completar",
          frase: "Els comptes del grup 3 corresponen a ___",
          opcions: ["actiu no corrent", "exist√®ncies", "clients", "tresoreria"],
          correcta: "exist√®ncies"
        },
        {
          tipus: "completar",
          frase: "La ___ representa l'obligaci√≥ de pagar a curt termini.",
          opcions: ["clientela", "tresoreria", "creditor", "factura"],
          correcta: "creditor"
        },
        {
          tipus: "completar",
          frase: "El compte (4751) 'Hisenda P√∫blica, creditora per retencions practicades' registra les retencions d'IRPF que l'empresa ha practicat i ha de pagar a ___.",
          opcions: ["empleats", "prove√Ødors", "Hisenda", "Seguretat Social"],
          correcta: "Hisenda"
        },
        {
          tipus: "completar",
          frase: "Un compte t√© un saldo ___ quan la suma de l'Haver √©s superior a la suma del Deure.",
          opcions: ["deutor", "null", "final", "creditor"],
          correcta: "creditor"
        },
        {
          tipus: "relacionar",
          pregunta: "Relaciona el grup amb el tipus de comptes:",
          parelles: [
            { esquerra: "Grup 2", opcions: ["Ingressos", "Immobilitzat", "Tresoreria"], correcta: "Immobilitzat" },
            { esquerra: "Grup 3", opcions: ["Tresoreria", "Exist√®ncies", "Passius"], correcta: "Exist√®ncies" },
            { esquerra: "Grup 5", opcions: ["Reserves", "Tresoreria", "Ingressos"], correcta: "Tresoreria" }
          ]
        },
        {
          tipus: "relacionar",
          pregunta: "Relaciona el concepte amb el compte del Passiu Corrent corresponent:",
          parelles: [
            { esquerra: "Deute per la compra de mercaderies a cr√®dit", opcions: ["(410) Creditors", "(400) Prove√Ødors", "(520) Pr√©stecs c/t"], correcta: "(400) Prove√Ødors" },
            { esquerra: "Quantitat a pagar a Hisenda per IVA de vendes", opcions: ["(472) IVA suportat", "(4750) HP, creditora per IVA", "(630) Impost sobre beneficis"], correcta: "(4750) HP, creditora per IVA" },
            { esquerra: "Deute amb la Seguretat Social per quotes pendents", opcions: ["(642) Seguretat Social a c√†rrec de l'empresa", "(476) Organismes de la Seguretat Social, creditors", "(465) Remuneracions de personal pendents"], correcta: "(476) Organismes de la Seguretat Social, creditors" }
          ]
        },
        {
          tipus: "relacionar",
          pregunta: "Relaciona els comptes amb la seva classificaci√≥:",
          parelles: [
            { esquerra: "(600) Compres de mercaderies", opcions: ["Ingr√©s", "Despesa d'explotaci√≥", "Despesa financera"], correcta: "Despesa d'explotaci√≥" },
            { esquerra: "(700) Venda de mercaderies", opcions: ["Ingr√©s financer", "Ingr√©s d'explotaci√≥", "Despesa d'explotaci√≥"], correcta: "Ingr√©s d'explotaci√≥" },
            { esquerra: "(640) Sous i salaris", opcions: ["Ingr√©s", "Despesa d'explotaci√≥", "Despesa financera"], correcta: "Despesa d'explotaci√≥" }
          ]
        },
{
  tipus: "completar",
  frase: "El resultat de l'exercici es calcula restant les despeses dels ___.",
  opcions: ["actius", "passius", "ingressos", "patrimoni net"],
  correcta: "ingressos"
},
{
  tipus: "completar",
  frase: "Les devolucions de vendes de mercaderies es registren al compte ___.",
  opcions: ["(700)", "(708)", "(709)", "(608)"],
  correcta: "(708)"
},
{
  tipus: "test",
  pregunta: "El compte (771) 'Beneficis procedents de l'immobilitzat intangible' s'usa en la ___ d'un element d'aquest tipus.",
  opcions: ["compra", "amortitzaci√≥", "venda", "revaloritzaci√≥"],
  correcta: 2
},
{
  tipus: "test",
  pregunta: "El compte (681) Amortitzaci√≥ de l‚Äôimmobilitzat, √©s de naturalesa:",
  opcions: ["Ingressos", "Despesa", "Passiu", "Actiu"],
  correcta: 1
},
{
  tipus: "relacionar",
  pregunta: "Relaciona el servei o despesa amb el seu compte del Grup 6:",
  parelles: [
    { esquerra: "Factura d'electricitat o aigua", opcions: ["(621)", "(628)", "(626)"], correcta: "(628)" },
    { esquerra: "Pagament a un assessor fiscal extern", opcions: ["(627)", "(623)", "(629)"], correcta: "(623)" },
    { esquerra: "Asseguran√ßa del local comercial", opcions: ["(625)", "(624)", "(622)"], correcta: "(625)" }
  ]
},
{
  tipus: "relacionar",
  pregunta: "Relaciona cada document amb el seu √∫s habitual:",
  parelles: [
    { esquerra: "Factura", opcions: ["Justificant d'una operaci√≥", "Control de saldos", "Resum comptable"], correcta: "Justificant d'una operaci√≥" },
    { esquerra: "Balan√ß", opcions: ["Resum comptable", "Llistat d'empleats", "Document fiscal"], correcta: "Resum comptable" },
    { esquerra: "Extracte bancari", opcions: ["Control de saldos", "Comprovant fiscal", "Amortitzaci√≥"], correcta: "Control de saldos" }
  ]
}
      ],
      3: [
        {
          tipus: "test",
          pregunta: "Quin √©s el per√≠ode d'amortitzaci√≥ m√†xim en anys per a 'Edificis industrials' segons la taula fiscal?",
          opcions: ["50 anys", "68 anys", "100 anys", "30 anys"],
          correcta: 1
        },
        {
          tipus: "test",
          pregunta: "El compte (650) 'P√®rdues de cr√®dits comercials incobrables' s'utilitza quan:",
          opcions: [
            "Un client paga amb retard",
            "Un client declara fallida i no pagar√† el seu deute",
            "L'empresa no pot pagar un deute",
            "Es concedeix un descompte a un client"
          ],
          correcta: 1
        },
        {
          tipus: "test",
          pregunta: "Quin compte correspon a una despesa de personal?",
          opcions: ["(623)", "(640)", "(628)", "(631)"],
          correcta: 1
        },
        {
          tipus: "test",
          pregunta: "Quin compte representa les devolucions de vendes?",
          opcions: ["(700)", "(708)", "(709)", "(608)"],
          correcta: 1
        },
{
    tipus: "test",
    pregunta: "El compte (523) 'Inversions financeres a curt termini en instruments de patrimoni' s'utilitza per a:",
    opcions: [
      "Accions d'altres empreses amb intenci√≥ de mantenir-les menys d'un any",
      "Deutes a llarg termini amb tercers",
      "Cr√®dits concedits a personal",
      "Immobilitzat material per a √∫s de l'empresa"
    ],
    correcta: 0
  },
        {
          tipus: "test",
          pregunta: "El compte (200) 'Despeses de recerca i desenvolupament' es classifica com a:",
          opcions: ["Immobilitzat material", "Immobilitzat financer", "Immobilitzat intangible", "Actiu corrent"],
          correcta: 2
        },
        {
          tipus: "test",
          pregunta: "Quants d√≠gits sol tenir un compte comptable del Pla General Comptable (PGC) en la seva m√†xima expressi√≥ de detall?",
          opcions: ["3 d√≠gits", "5 d√≠gits", "7 d√≠gits", "9 d√≠gits"],
          correcta: 2
        },
        {
          tipus: "test",
          pregunta: "Una 'Variaci√≥ d'exist√®ncies de mercaderies' negativa normalment significa que:",
          opcions: [
            "L'empresa ha comprat m√©s mercaderies de les que ha venut",
            "L'empresa ha venut m√©s mercaderies de les que ha comprat",
            "Les mercaderies s'han revaloritzat",
            "No hi ha hagut moviment de mercaderies"
          ],
          correcta: 1
        },
        {
          tipus: "completar",
          frase: "L'amortitzaci√≥ √©s la p√®rdua de valor que experimenta un actiu immobilitzat per ___ o √∫s.",
          opcions: ["venda", "inflaci√≥", "antiguitat", "caducitat"],
          correcta: "antiguitat"
        },
        {
	tipus: "completar",
          frase: "L'amortitzaci√≥ de l'immobilitzat intangible s'acumula al compte (___).",
          opcions: ["280", "281", "680", "681"],
          correcta: "280"
        },
        {
          tipus: "completar",
          frase: "Les imposicions a llarg termini realitzades per l'empresa es registren al compte (___).",
          opcions: ["540", "572", "258", "170"],
          correcta: "258"
        },
        {
          tipus: "relacionar",
          pregunta: "Relaciona l'element amb el seu per√≠ode m√†xim d'amortitzaci√≥ segons la taula fiscal:",
          parelles: [
            { esquerra: "Mobiliari", opcions: ["18 anys", "10 anys", "20 anys"], correcta: "20 anys" },
            { esquerra: "Autocamions", opcions: ["20 anys", "14 anys", "10 anys"], correcta: "10 anys" },
            { esquerra: "Cables (instal¬∑lacions)", opcions: ["40 anys", "20 anys", "30 anys"], correcta: "30 anys" }
          ]
        },
        {
          tipus: "relacionar",
          pregunta: "Relaciona el compte amb el seu grup principal dins del compte de P√®rdues i Guanys:",
          parelles: [
            { esquerra: "(600) Compres de mercaderies", opcions: ["Despesa financera", "Ingr√©s", "Despesa d'explotaci√≥"], correcta: "Despesa d'explotaci√≥" },
            { esquerra: "(700) Venda de mercaderies", opcions: ["Despesa d'explotaci√≥", "Ingr√©s financer", "Ingr√©s d'explotaci√≥"], correcta: "Ingr√©s d'explotaci√≥" },
            { esquerra: "(640) Sous i salaris", opcions: ["Ingr√©s", "Despesa financera", "Despesa d'explotaci√≥"], correcta: "Despesa d'explotaci√≥" }
          ]
        },
        {
          tipus: "relacionar",
          pregunta: "Relaciona el servei o despesa amb el seu compte del Grup 6:",
          parelles: [
            { esquerra: "Factura d'electricitat o aigua", opcions: ["(626) Serveis bancaris", "(621) Arrendaments", "(628) Subministraments"], correcta: "(628) Subministraments" },
            { esquerra: "Pagament a un assessor fiscal extern", opcions: ["(627) Publicitat", "(629) Altres serveis", "(623) Serveis de professionals independents"], correcta: "(623) Serveis de professionals independents" },
            { esquerra: "Asseguran√ßa del local comercial", opcions: ["(624) Transport", "(622) Reparacions", "(625) Primes d'assegurances"], correcta: "(625) Primes d'assegurances" }
          ]
        },
{
  tipus: "test",
  pregunta: "Quin d'aquests comptes representa un deute financer a curt termini?",
  opcions: ["(171)", "(400)", "(520)", "(475)"],
  correcta: 2
},
{
  tipus: "test",
  pregunta: "Quin compte s'utilitza per registrar els deutes amb personal (salaris pendents de pagament)?",
  opcions: ["(460)", "(465)", "(476)", "(430)"],
  correcta: 1
},
{
  tipus: "test", // Canviem a tipus "test" per a una pregunta m√©s directa sobre el compte
  pregunta: "El compte (4312) 'Efectes comercials en gesti√≥ de cobrament' s'utilitza per a:",
  opcions: [
    "Factures de clients que encara no han ven√ßut",
    "Lletres de canvi o pagar√©s de clients que s'han enviat al banc per a la seva gesti√≥ de cobrament per√≤ encara no s'han cobrat",
    "Cr√®dits de dubt√≥s cobrament amb clients",
    "Descomptes de vendes per pagament r√†pid"
  ],
  correcta: 1 // La segona opci√≥ √©s la correcta
},
{
  tipus: "completar",
  frase: "Les ___ s√≥n aquells materials que, per transformaci√≥ o combinaci√≥, passen a formar part dels productes fabricats.",
  opcions: ["mercaderies", "productes acabats", "mat√®ries primeres", "residus"],
  correcta: "mat√®ries primeres"
},
{
  tipus: "relacionar",
  pregunta: "Relaciona cada tipus d'exist√®ncia amb el seu estat en el proc√©s productiu:",
  parelles: [
    { esquerra: "(330) Productes en curs", opcions: ["Ja venuts", "En proc√©s de fabricaci√≥", "Llests per a la venda"], correcta: "En proc√©s de fabricaci√≥" },
    { esquerra: "(300) Mercaderies", opcions: ["Destinats a la venda sense transformaci√≥", "Components per a la fabricaci√≥", "Elements sense valor comercial"], correcta: "Destinats a la venda sense transformaci√≥" },
    { esquerra: "(360) Subproductes", opcions: ["Productes principals", "Resultats secundaris i accessoris de la fabricaci√≥", "Residus reciclables sense valor"], correcta: "Resultats secundaris i accessoris de la fabricaci√≥" }
  ]
},
{
  tipus: "relacionar",
  pregunta: "Classifica aquests comptes de l'Actiu Corrent segons la seva disponibilitat:",
  parelles: [
    { esquerra: "(430) Clients", opcions: ["Disponible", "Realitzable", "Exist√®ncies"], correcta: "Realitzable" },
    { esquerra: "(572) Bancs c/c vista", opcions: ["Exist√®ncies", "Disponible", "Realitzable"], correcta: "Disponible" },
    { esquerra: "(4700) HP, deutora per diversos conceptes", opcions: ["Exist√®ncies", "Disponible", "Realitzable"], correcta: "Realitzable" }
  ]
}
      ],
      4: [
        {
          tipus: "test",
          pregunta: "Quina de les seg√ºents afirmacions sobre el 'Patrimoni Net' √©s correcta?",
          opcions: [
            "Representa el total de deutes de l'empresa",
            "√âs la part de l'Actiu finan√ßada pels propietaris i beneficis no distribu√Øts",
            "Inclou tots els b√©ns i drets de l'empresa",
            "S√≥n les obligacions a curt termini amb prove√Ødors"
          ],
          correcta: 1
        },
        {
          tipus: "test",
          pregunta: "Quan l'IVA suportat √©s superior a l'IVA repercutit, el resultat de la liquidaci√≥ d'IVA √©s normalment a:",
          opcions: [
            "Pagar a Hisenda",
            "Compensar en futures liquidacions",
            "Rebre de Hisenda",
            "Zero, es cancel¬∑la"
          ],
          correcta: 1
        },
        {
          tipus: "test",
          pregunta: "Una 'reserva legal' es forma amb part dels beneficis i t√© un car√†cter:",
          opcions: [
            "Disponible i exigible",
            "Obligatori i indisponible",
            "Voluntari i disponible",
            "Deute a curt termini"
          ],
          correcta: 1
        },
        {
          tipus: "test",
          pregunta: "Quin document comptable serveix per verificar que la suma dels saldos deutors √©s igual a la dels creditors?",
          opcions: [
            "Balan√ß de Situaci√≥",
            "Compte de P√®rdues i Guanys",
            "Balan√ß de Sumes i Saldos",
            "Estat de Fluxos d'Efectiu"
          ],
          correcta: 2
        },
        {
          tipus: "test",
          pregunta: "Quin √©s l'objectiu principal de l'Estat de Fluxos d'Efectiu?",
          opcions: [
            "Mostrar els ingressos i despeses",
            "Informar sobre els moviments de caixa i equivalents",
            "Presentar els actius i passius",
            "Calcular la rendibilitat financera"
          ],
          correcta: 1
        },
        {
          tipus: "test",
          pregunta: "Quin m√®tode comptable empra la partida doble?",
          opcions: [
            "Unigr√†fica",
            "Digr√†fica",
            "Anal√≠tica",
            "Fiscocontable"
          ],
          correcta: 1
        },
        {
          tipus: "test",
          pregunta: "Qu√® significa que un compte est√† saldat?",
          opcions: [
            "Que nom√©s t√© saldo deutor",
            "Que nom√©s t√© saldo creditor",
            "Que el seu deure i haver estan igualats",
            "Que est√† tancat per falta d'√∫s"
          ],
          correcta: 2
        },
        {
          tipus: "test",
          pregunta: "En comptabilitat, qu√® representa la situaci√≥ D > H?",
          opcions: [
            "Saldo creditor",
            "Saldo negatiu",
            "Saldo deutor",
            "Compte tancat"
          ],
          correcta: 2
        },
{
  tipus: "test",
  pregunta: "Quin llibre inclou el balan√ß de situaci√≥ i el compte de p√®rdues i guanys?",
  opcions: [
    "Llibre Diari",
    "Llibre Major",
    "Llibre d'Inventaris i Comptes Anuals",
    "Mem√≤ria"
  ],
  correcta: 2
},
 {
    tipus: "test",
    pregunta: "El compte (173) 'Prove√Ødors d'immobilitzat a llarg termini' registra:",
    opcions: [
      "Els deutes amb prove√Ødors per compra de mercaderies a llarg termini",
      "Els deutes amb tercers per la compra d'actius fixos amb venciment superior a un any",
      "Els cr√®dits concedits a clients a llarg termini",
      "Els deutes amb entitats de cr√®dit a llarg termini"
    ],
    correcta: 1
  },
{
  tipus: "completar",
  frase: "El tipus general d'IVA a Espanya aplicat a la majoria de b√©ns i serveis √©s del ___%.",
  opcions: ["4", "10", "21", "18"],
  correcta: "21"
},
{
  tipus: "completar",
  frase: "El compte (440) 'Deutors diversos' representa els drets de cobrament per operacions no ___.",
  opcions: ["financers", "comercials", "banc√†ries", "impositives"],
  correcta: "comercials"
},
{
  tipus: "relacionar",
  pregunta: "Relaciona el concepte amb el compte del Finan√ßament B√†sic corresponent:",
  parelles: [
    {
      esquerra: "Benefici o p√®rdua de l'exercici actual",
      opcions: ["(100)", "(112)", "(129)"],
      correcta: "(129)"
    },
    {
      esquerra: "Aportacions dels socis a l'empresa",
      opcions: ["(112)", "(100)", "(171)"],
      correcta: "(100)"
    },
    {
      esquerra: "Deutes financers amb venciment superior a un any",
      opcions: ["(171)", "(520)", "(400)"],
      correcta: "(171)"
    }
  ]
},
{
  tipus: "relacionar",
  pregunta: "Relaciona l'estat financer amb el seu objectiu principal:",
  parelles: [
    {
      esquerra: "Estat de Fluxos d'Efectiu",
      opcions: [
        "Mostrar els ingressos i despeses",
        "Informar sobre els moviments de caixa i equivalents",
        "Presentar els actius i passius"
      ],
      correcta: "Informar sobre els moviments de caixa i equivalents"
    },
    {
      esquerra: "Proc√©s comptable",
      opcions: [
        "Obtenir un resum del Balan√ß",
        "Seq√º√®ncia d'activitats des de l'assentament fins als estats financers",
        "Valorar els actius immobilitzats"
      ],
      correcta: "Seq√º√®ncia d'activitats des de l'assentament fins als estats financers"
    }
  ]
},
        {
          tipus: "completar",
          frase: "El conjunt d'elements que constitueixen l'estructura econ√≤mica de l'empresa es coneix com a ___.",
          opcions: ["passiu", "finan√ßament", "actiu", "balan√ß"],
          correcta: "actiu"
        },
        {
          tipus: "completar",
          frase: "L'___ de Canvis en el Patrimoni Net mostra les variacions produ√Ødes en els fons propis de l'empresa durant l'exercici.",
          opcions: ["Informe", "Estat", "Resum", "Quadre"],
          correcta: "Estat"
        },
        {
          tipus: "completar",
          frase: "El cicle comptable s'inicia amb el registre de les transaccions en el llibre ___.",
          opcions: ["Major", "Inventaris", "Diari", "Balan√ß"],
          correcta: "Diari"
        },
        {
          tipus: "completar",
          frase: "Les imposicions a curt termini de l'empresa en bancs es registren al compte (___).",
          opcions: ["570", "572", "540", "550"],
          correcta: "540"
        },
        {
          tipus: "relacionar",
          pregunta: "Relaciona l'apartat del Balan√ß de Situaci√≥ amb la seva naturalesa:",
          parelles: [
            {
              esquerra: "Actiu No Corrent",
              opcions: [
                "Obligacions a curt termini",
                "B√©ns i drets que romanen m√©s d'un any",
                "Finan√ßament aportat pels socis"
              ],
              correcta: "B√©ns i drets que romanen m√©s d'un any"
            },
            {
              esquerra: "Passiu Corrent",
              opcions: [
                "Deutes amb venciment inferior a un any",
                "Obligacions amb venciment superior a un any",
                "Finan√ßament propi"
              ],
              correcta: "Deutes amb venciment inferior a un any"
            },
            {
              esquerra: "Patrimoni Net",
              opcions: [
                "Obligacions amb bancs a llarg termini",
                "Finan√ßament aportat per propietaris i reserves",
                "B√©ns i drets a curt termini"
              ],
              correcta: "Finan√ßament aportat per propietaris i reserves"
            }
          ]
        },
        {
          tipus: "relacionar",
          pregunta: "Relaciona el tipus d'immobilitzat intangible amb la seva definici√≥:",
          parelles: [
            {
              esquerra: "(201) Concessions administratives",
              opcions: [
                "Dret d'explotar un servei p√∫blic",
                "Programa inform√†tic d'√∫s intern",
                "Dret sobre una marca registrada"
              ],
              correcta: "Dret d'explotar un servei p√∫blic"
            },
            {
              esquerra: "(203) Propietat industrial",
              opcions: [
                "Drets d'explotaci√≥ de mines",
                "Drets sobre patentes i marques",
                "Dretes d'autor de llibres"
              ],
              correcta: "Drets sobre patentes i marques"
            },
            {
              esquerra: "(206) Aplicacions inform√†tiques",
              opcions: [
                "Maquinari d'ordinadors",
                "Llic√®ncies de programari i desenvolupament",
                "Equips de comunicaci√≥"
              ],
              correcta: "Llic√®ncies de programari i desenvolupament"
            }
          ]
        },
        {
          tipus: "relacionar",
          pregunta: "Relaciona cada llibre comptable obligatori amb la informaci√≥ que proporciona:",
          parelles: [
            {
              esquerra: "Llibre Diari",
              opcions: [
                "Resum detallat per compte",
                "Informaci√≥ d'exist√®ncies al final de l'any",
                "Registre cronol√≤gic de totes les operacions"
              ],
              correcta: "Registre cronol√≤gic de totes les operacions"
            },
            {
              esquerra: "Llibre d'Inventaris i Comptes Anuals",
              opcions: [
                "Moviments de caixa i bancs",
                "Transaccions del dia a dia",
                "Balan√ß de situaci√≥ i compte de p√®rdues i guanys"
              ],
              correcta: "Balan√ß de situaci√≥ i compte de p√®rdues i guanys"
            },
            {
              esquerra: "Llibre Major (√∫s intern)",
              opcions: [
                "Moviments agregats per compte",
                "Assentaments d'ajustament de tancament",
                "Resum diari de vendes"
              ],
              correcta: "Moviments agregats per compte"
            }
          ]
        }
      ]
    };

    let preguntesPendents = [];
    let encerts = 0;
    let preguntesRespostes = 0; // Preguntes contestades (correctes + incorrectes)
    let totalPreguntesNivell = 0; // Total de preguntes en el nivell actual

    let quizContainer;
    let nextBtn;
    let score;
    let progressBar;
    let progressFill;

    document.addEventListener('DOMContentLoaded', () => {
      quizContainer = document.getElementById("quiz-container");
      nextBtn = document.getElementById("next-btn");
      score = document.getElementById("score");

      progressBar = document.createElement("div");
      progressBar.className = "w-full bg-gray-300 h-2 rounded overflow-hidden mt-4";
      progressFill = document.createElement("div");
      progressFill.className = "h-full bg-blue-500";
      progressFill.style.width = "0%";
      progressBar.appendChild(progressFill);
      quizContainer.before(progressBar); // Add progress bar before quiz container

      nextBtn.addEventListener("click", mostraPregunta);
    });

    // Funci√≥ per barrejar un array (Fisher-Yates shuffle)
    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    function iniciaNivell(n) {
      if (!Array.isArray(nivells[n])) {
        alert("Aquest nivell no est√† disponible o no cont√© preguntes.");
        return;
      }
      // Crea una c√≤pia del nivell i la barreja
      preguntesPendents = [...nivells[n]];
      shuffleArray(preguntesPendents); // BARREJA LES PREGUNTES AQU√ç

      totalPreguntesNivell = preguntesPendents.length;
      encerts = 0;
      preguntesRespostes = 0;
      score.textContent = `Encerts: ${encerts} / ${preguntesRespostes}`; // Actualitza per mostrar 0/0 inicialment
      updateProgress(); // Actualitza la barra de progr√©s a 0%
      mostraPregunta();
    }

    function mostraPregunta() {
      quizContainer.innerHTML = "";
      nextBtn.classList.add("hidden");
      
      if (preguntesPendents.length === 0) {
        quizContainer.innerHTML = `
          <div class="text-center">
            <p class="text-xl font-semibold mb-4">üéâ Has completat el nivell!</p>
            <p class="mb-4">Has encertat ${encerts} de ${totalPreguntesNivell} preguntes.</p>
          </div>`;
        return;
      }

      const actual = preguntesPendents.shift(); // Defineix 'actual' dins d'aquesta funci√≥ per ser m√©s consistent
      quizContainer.dataset.currentQuestionType = actual.tipus; // Guarda el tipus de pregunta

      if (actual.tipus === "test") {
        const opcionsHTML = actual.opcions.map((text, i) => `
          <button onclick="validaResposta(${i}, this)" class="w-full text-left px-4 py-2 mb-2 border rounded bg-gray-100 hover:bg-gray-200 opc">${text}</button>
        `).join("");
        quizContainer.innerHTML = `<p class="mb-4 font-medium">${actual.pregunta}</p><div id="opcions-container">${opcionsHTML}</div><div id="feedback" class="mt-4 text-center"></div>`;
      } else if (actual.tipus === "completar") {
        const selectHTML = `<select id="select-frase" class="mx-1 border rounded px-2 py-1">
          <option value="">-- Selecciona --</option> ${actual.opcions.map(o => `<option>${o}</option>`).join("")}
        </select>`;
        const fraseAmbSelect = actual.frase.replace("___", selectHTML);
        quizContainer.innerHTML = `<p class="mb-4">${fraseAmbSelect}</p>
          <button id="comprovar-btn" onclick="validaCompletar()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 mt-2">Comprovar</button>
          <div id="feedback" class="mt-4 text-center"></div>`;
      } else if (actual.tipus === "relacionar") {
        let html = `<p class="mb-4">${actual.pregunta}</p><div class="space-y-4" id="relacionar-container">`;
        actual.parelles.forEach((p, i) => {
          html += `<div>${p.esquerra}: <select data-index="${i}" class="border rounded px-2 py-1">
            <option value="">-- Selecciona --</option> ${p.opcions.map(o => `<option>${o}</option>`).join("")}</select></div>`;
        });
        html += `</div><button id="comprovar-btn" onclick="validaRelacionar()" class="mt-4 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Comprovar</button><div id="feedback" class="mt-4 text-center"></div>`;
        quizContainer.innerHTML = html;
      }
      // Emmagatzemem la pregunta actual per a la validaci√≥ posterior
      quizContainer.currentQuestion = actual; 
    }

    // Funci√≥ per bloquejar la interacci√≥ amb les opcions de la pregunta actual
    function bloquejaInteraccio() {
        const tipus = quizContainer.dataset.currentQuestionType;
        if (tipus === "test") {
            const botons = quizContainer.querySelectorAll(".opc");
            botons.forEach(btn => btn.disabled = true);
        } else if (tipus === "completar") {
            document.getElementById("select-frase").disabled = true;
            document.getElementById("comprovar-btn").disabled = true;
        } else if (tipus === "relacionar") {
            const selects = quizContainer.querySelectorAll("#relacionar-container select");
            selects.forEach(s => s.disabled = true);
            document.getElementById("comprovar-btn").disabled = true;
        }
    }

    function validaResposta(index, clickedButton) {
      // Si ja s'ha contestat, ignora el clic
      if (nextBtn.classList.contains("hidden") === false) { // Si el bot√≥ 'next' ja √©s visible, vol dir que ja s'ha respost
        return;
      }

      const feedback = document.getElementById("feedback");
      const actual = quizContainer.currentQuestion; // Recupera la pregunta actual

      // Incrementa el comptador de preguntes respostes quan es contesta per primera vegada
      preguntesRespostes++; 

      if (index === actual.correcta) {
        encerts++;
        feedback.innerHTML = "<p class='text-green-600 font-bold'>üòä Correcte!</p>";
        clickedButton.classList.remove("bg-gray-100");
        clickedButton.classList.add("bg-green-200", "border-green-500");
      } else {
        feedback.innerHTML = "<p class='text-red-600 font-bold'>üò¢ Incorrecte!</p>";
        clickedButton.classList.remove("bg-gray-100");
        clickedButton.classList.add("bg-red-200", "border-red-500");

        // Opcional: Ressaltar la resposta correcta
        const opcions = quizContainer.querySelectorAll(".opc");
        opcions[actual.correcta].classList.add("bg-green-200", "border-green-500");
      }
      score.textContent = `Encerts: ${encerts} / ${preguntesRespostes}`; // MOSTRA ENCERTS / PREGUNTES FETES
      updateProgress();
      nextBtn.classList.remove("hidden"); // Mostra el bot√≥ "Seg√ºent"
      bloquejaInteraccio(); // Bloqueja les opcions
    }

    function validaCompletar() {
      // Si ja s'ha contestat, ignora el clic
      if (nextBtn.classList.contains("hidden") === false) {
        return;
      }
      
      const select = document.getElementById("select-frase");
      const valor = select.value;
      const feedback = document.getElementById("feedback");
      const actual = quizContainer.currentQuestion; // Recupera la pregunta actual

      // Incrementa el comptador de preguntes respostes
      preguntesRespostes++;

      if (valor === actual.correcta) {
        encerts++;
        feedback.innerHTML = "<p class='text-green-600 font-bold'>üòä Correcte!</p>";
        select.classList.add("bg-green-200", "border-green-500");
      } else {
        feedback.innerHTML = "<p class='text-red-600 font-bold'>üò¢ Incorrecte!</p>";
        select.classList.add("bg-red-200", "border-red-500");
        // Opcional: Mostrar la resposta correcta
        feedback.innerHTML += `<p class="text-sm text-gray-700 mt-1">La resposta correcta era: <strong>${actual.correcta}</strong></p>`;
      }
      score.textContent = `Encerts: ${encerts} / ${preguntesRespostes}`; // MOSTRA ENCERTS / PREGUNTES FETES
      updateProgress();
      nextBtn.classList.remove("hidden"); // Mostra el bot√≥ "Seg√ºent"
      bloquejaInteraccio(); // Bloqueja les opcions
    }

    function validaRelacionar() {
      // Si ja s'ha contestat, ignora el clic
      if (nextBtn.classList.contains("hidden") === false) {
        return;
      }

      const selects = quizContainer.querySelectorAll("select[data-index]");
      let correctes = 0;
      const feedback = document.getElementById("feedback");
      const actual = quizContainer.currentQuestion; // Recupera la pregunta actual

      // Incrementa el comptador de preguntes respostes
      preguntesRespostes++;

      selects.forEach((s, i) => {
        if (s.value === actual.parelles[i].correcta) {
            correctes++;
            s.classList.add("bg-green-200", "border-green-500");
        } else {
            s.classList.add("bg-red-200", "border-red-500");
        }
      });
      
      if (correctes === actual.parelles.length) {
        encerts++;
        feedback.innerHTML = "<p class='text-green-600 font-bold'>üòä Molt b√©!</p>";
      } else {
        feedback.innerHTML = "<p class='text-red-600 font-bold'>‚ùå Revisa les respostes.</p>";
        // Opcional: Mostrar les respostes correctes
        let respostesCorrectesHtml = "<p class='text-sm text-gray-700 mt-1'>Respostes correctes:</p><ul>";
        actual.parelles.forEach((p) => {
            respostesCorrectesHtml += `<li>${p.esquerra}: <strong>${p.correcta}</strong></li>`;
        });
        respostesCorrectesHtml += "</ul>";
        feedback.innerHTML += respostesCorrectesHtml;
      }
      score.textContent = `Encerts: ${encerts} / ${preguntesRespostes}`; // MOSTRA ENCERTS / PREGUNTES FETES
      updateProgress();
      nextBtn.classList.remove("hidden"); // Mostra el bot√≥ "Seg√ºent"
      bloquejaInteraccio(); // Bloqueja les opcions
    }

    function updateProgress() {
      // El percentatge es calcula en base a les preguntes que ja s'han respost (preguntesRespostes)
      // respecte al total de preguntes del nivell (totalPreguntesNivell).
      const percentatge = totalPreguntesNivell > 0 ? (preguntesRespostes / totalPreguntesNivell) * 100 : 0;
      progressFill.style.width = `${percentatge}%`;
    }
  </script>
</body>
</html>
